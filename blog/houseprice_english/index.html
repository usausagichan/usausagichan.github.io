<!DOCTYPE html>
<html lang="zh-tw"><head>
  <meta charset="utf-8">
  <title>My Project</title>

  <!-- mobile responsive meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content=" How much should a house be sold for to meet the market? The most immediate factors we would think of to determine this would be the location and square footage of the house. In reality, there are many other factors that can affect house prices. Let&#39;s use the Boston Housing dataset on Kaggle to explore this.">
  <meta name="author" content="CT Chen">
    
  
  <meta name="theme-name" content="liva-hugo" />
  
  <meta name="generator" content="Hugo 0.109.0">

  <!-- plugins -->
  
  <link rel="stylesheet" href="https://usausagichan.github.io/english_version/plugins/bootstrap/bootstrap.min.css ">
  
  <link rel="stylesheet" href="https://usausagichan.github.io/english_version/plugins/slick/slick.css ">
  
  <link rel="stylesheet" href="https://usausagichan.github.io/english_version/plugins/themify-icons/themify-icons.css ">
  
  <link rel="stylesheet" href="https://usausagichan.github.io/english_version/plugins/venobox/venobox.css ">
  

  <!-- Main Stylesheet -->
  
  <link rel="stylesheet" href="https://usausagichan.github.io/english_version/scss/style.min.css" media="screen">

  <!--Favicon-->
  <link rel="shortcut icon" href="https://usausagichan.github.io/english_version/images/favicon.png " type="image/x-icon">
  <link rel="icon" href="https://usausagichan.github.io/english_version/images/favicon.png " type="image/x-icon">
  
  <!-- google analitycs -->
  <script>
    (function (i, s, o, g, r, a, m) {
      i['GoogleAnalyticsObject'] = r;
      i[r] = i[r] || function () {
        (i[r].q = i[r].q || []).push(arguments)
      }, i[r].l = 1 * new Date();
      a = s.createElement(o),
        m = s.getElementsByTagName(o)[0];
      a.async = 1;
      a.src = g;
      m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
    ga('create', 'UA-256135790-1', 'auto');
    ga('send', 'pageview');
  </script>

</head>
<body>
<!-- preloader start -->
<div class="preloader">
  
</div>
<!-- preloader end -->
<!-- navigation -->
<header class="navigation">
  <div class="container">
    
    <nav class="navbar navbar-expand-lg navbar-white bg-transparent border-bottom pl-0">
      <a class="navbar-brand mobile-view" href="https://usausagichan.github.io/english_version/"><img class="img-fluid"
          src="https://usausagichan.github.io/english_version/images/Picture1.png" alt="My Project"></a>
      <button class="navbar-toggler border-0" type="button" data-toggle="collapse" data-target="#navigation">
        <i class="ti-menu"></i>
      </button>

      <div class="collapse navbar-collapse text-center" id="navigation">
        <div class="desktop-view">
          <ul class="navbar-nav mr-auto">
            
            <li class="nav-item">
              <a class="nav-link" href="https://github.com/usausagichan"><i class="ti-github"></i></a>
            </li>
            
            <li class="nav-item">
              <a class="nav-link" href="https://www.linkedin.com/in/%E7%B7%BB%E5%BA%AD-%E9%99%B3-3274b0224/"><i class="ti-linkedin"></i></a>
            </li>
            
          </ul>
        </div>

        <a class="navbar-brand mx-auto desktop-view" href="https://usausagichan.github.io/english_version/"><img class="img-fluid"
            src="https://usausagichan.github.io/english_version/images/Picture1.png" alt="My Project"></a>

        <ul class="navbar-nav">
          
          
          <li class="nav-item">
            <a class="nav-link" href="https://usausagichan.github.io/english_version/blog/">Post</a>
          </li>
          
          
        </ul>

        
        <!-- search -->
        <div class="search pl-lg-4">
          <button id="searchOpen" class="search-btn"><i class="ti-search"></i></button>
          <div class="search-wrapper">
            <form action="https://usausagichan.github.io/english_version//search" class="h-100">
              <input class="search-box px-4" id="search-query" name="s" type="search" placeholder="Type & Hit Enter...">
            </form>
            <button id="searchClose" class="search-close"><i class="ti-close text-dark"></i></button>
          </div>
        </div>
        

        
      </div>
    </nav>
  </div>
</header>
<!-- /navigation -->

<section class="section-sm">
  <div class="container">
    <div class="row">
      <div class="col-lg-10 mx-auto">
        
        <a href="/english_version/categories/project"
          class="text-primary">Project</a>
        
        <h2>Kaggle-House Price Prediction Practice</h2>
        <div class="mb-3 post-meta">
          <span>By CT Chen</span>
          
          <span class="border-bottom border-primary px-2 mx-1"></span>
          <span>01 January 0001</span>
          
        </div>
        
        <img src="https://usausagichan.github.io/english_version/images/featured-post/house.jpg" class="img-fluid w-100 mb-4" alt="Kaggle-House Price Prediction Practice">
        
        <div class="content mb-5">
          <p><em>How much should a house be sold for to meet the market? The most immediate factors we would think of to determine this would be the location and square footage of the house. In reality, there are many other factors that can affect house prices. Let&rsquo;s use the Boston Housing dataset on Kaggle to explore this.</em></p>
<p>The dataset is on: <a href="https://www.kaggle.com/c/house-prices-advanced-regression-techniques">https://www.kaggle.com/c/house-prices-advanced-regression-techniques</a></p>
<p>First, I will import the necessary packages and load the training and testing datasets.</p>
<p>Then, for data preprocessing, I will:</p>
<ol>
<li>Visualize the data and transform or remove features which seem unrelated to the house price or strongly related to other features.</li>
<li>Understand the meaning of each feature, fill in missing values and perform one-hot encoding</li>
<li>Use Lasso for feature selection</li>
</ol>
<p>Next, I will use the XGBoost model and perform 5-fold cross validation to select appropriate parameters. Finally, I will use the trained model to make house price predictions.</p>
<h1 id="import-the-necessary-packages-and-datasets">import the necessary packages and datasets</h1>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#6e6a86">#load module, data</span>
</span></span><span style="display:flex;"><span><span style="color:#c4a7e7">import</span> <span style="color:#ea9a97">pandas</span> <span style="color:#3e8fb0">as</span> <span style="color:#ea9a97">pd</span>
</span></span><span style="display:flex;"><span><span style="color:#c4a7e7">import</span> <span style="color:#ea9a97">numpy</span> <span style="color:#3e8fb0">as</span> <span style="color:#ea9a97">np</span>
</span></span><span style="display:flex;"><span><span style="color:#c4a7e7">import</span> <span style="color:#ea9a97">sklearn</span> <span style="color:#3e8fb0">as</span> <span style="color:#ea9a97">sci</span>
</span></span><span style="display:flex;"><span><span style="color:#c4a7e7">import</span> <span style="color:#ea9a97">matplotlib.pyplot</span> <span style="color:#3e8fb0">as</span> <span style="color:#ea9a97">plt</span>
</span></span><span style="display:flex;"><span><span style="color:#c4a7e7">import</span> <span style="color:#ea9a97">seaborn</span> <span style="color:#3e8fb0">as</span> <span style="color:#ea9a97">sns</span>
</span></span><span style="display:flex;"><span><span style="color:#c4a7e7">import</span> <span style="color:#ea9a97">scipy.stats</span> <span style="color:#3e8fb0">as</span> <span style="color:#ea9a97">stats</span>
</span></span><span style="display:flex;"><span><span style="color:#c4a7e7">import</span> <span style="color:#ea9a97">xgboost</span> <span style="color:#3e8fb0">as</span> <span style="color:#ea9a97">xgb</span>
</span></span><span style="display:flex;"><span><span style="color:#c4a7e7">from</span> <span style="color:#ea9a97">sklearn.model_selection</span> <span style="color:#c4a7e7">import</span> <span style="color:#ea9a97">GridSearchCV</span>
</span></span><span style="display:flex;"><span><span style="color:#c4a7e7">from</span> <span style="color:#ea9a97">sklearn.linear_model</span> <span style="color:#c4a7e7">import</span> <span style="color:#ea9a97">LassoCV</span>
</span></span><span style="display:flex;"><span><span style="color:#c4a7e7">from</span> <span style="color:#ea9a97">sklearn.feature_selection</span> <span style="color:#c4a7e7">import</span> <span style="color:#ea9a97">SelectFromModel</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">train</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">pd</span><span style="color:#908caa">.</span><span style="color:#ea9a97">read_csv</span><span style="color:#908caa">(</span><span style="color:#f6c177">&#34;train.csv&#34;</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">test</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">pd</span><span style="color:#908caa">.</span><span style="color:#ea9a97">read_csv</span><span style="color:#908caa">(</span><span style="color:#f6c177">&#34;test.csv&#34;</span><span style="color:#908caa">)</span>
</span></span></code></pre></div><h1 id="data-preprocessing">Data Preprocessing：</h1>
<p>I merged the features of the training and testing data sets for uniform processing. This not only facilitates the process but also avoids the issue of inconsistent scaling when normalizing separately.</p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ea9a97">dtrain</span><span style="color:#908caa">=</span><span style="color:#ea9a97">train</span><span style="color:#908caa">.</span><span style="color:#ea9a97">drop</span><span style="color:#908caa">([</span><span style="color:#f6c177">&#39;SalePrice&#39;</span><span style="color:#908caa">],</span><span style="color:#ea9a97">axis</span><span style="color:#908caa">=</span><span style="color:#f6c177">1</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">database</span><span style="color:#908caa">=</span><span style="color:#ea9a97">pd</span><span style="color:#908caa">.</span><span style="color:#ea9a97">concat</span><span style="color:#908caa">([</span><span style="color:#ea9a97">dtrain</span><span style="color:#908caa">,</span><span style="color:#ea9a97">test</span><span style="color:#908caa">])</span>
</span></span></code></pre></div><p>First, I roughly divide the data into &lsquo;object_type&rsquo; (qualitative) and &rsquo;numerical_type&rsquo; (quantitative).</p>
<p>According to the data_description file on the official website, it provides detailed descriptions of each feature.</p>
<p><a href="https://drive.google.com/file/d/17sT4kM4qbzHlQ9zO-V1ZK81Gdlm8YVQ6/view?usp=sharing">https://drive.google.com/file/d/17sT4kM4qbzHlQ9zO-V1ZK81Gdlm8YVQ6/view?usp=sharing</a></p>
<p>It can be inferred from the data description file on the official website that the integers in feature &lsquo;MSSubClass&rsquo; actually represent different categories of house transactions, and the numerical values have no direct relationship with their actual meanings. Therefore, its data type should be converted from integer to string.</p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#6e6a86">#datacleaning</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">realobj</span><span style="color:#908caa">=</span><span style="color:#908caa">[</span><span style="color:#f6c177">&#39;MSSubClass&#39;</span><span style="color:#908caa">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">database</span><span style="color:#908caa">[</span><span style="color:#ea9a97">realobj</span><span style="color:#908caa">]</span><span style="color:#908caa">=</span><span style="color:#ea9a97">database</span><span style="color:#908caa">[</span><span style="color:#ea9a97">realobj</span><span style="color:#908caa">]</span><span style="color:#908caa">.</span><span style="color:#ea9a97">astype</span><span style="color:#908caa">(</span><span style="color:#ea9a97">str</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">quant</span> <span style="color:#908caa">=</span> <span style="color:#908caa">[</span><span style="color:#ea9a97">f</span> <span style="color:#3e8fb0">for</span> <span style="color:#ea9a97">f</span> <span style="color:#908caa">in</span> <span style="color:#ea9a97">database</span><span style="color:#908caa">.</span><span style="color:#ea9a97">columns</span> <span style="color:#3e8fb0">if</span> <span style="color:#ea9a97">database</span><span style="color:#908caa">.</span><span style="color:#ea9a97">dtypes</span><span style="color:#908caa">[</span><span style="color:#ea9a97">f</span><span style="color:#908caa">]</span> <span style="color:#908caa">!=</span> <span style="color:#f6c177">&#39;object&#39;</span><span style="color:#908caa">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">quali</span> <span style="color:#908caa">=</span> <span style="color:#908caa">[</span><span style="color:#ea9a97">f</span> <span style="color:#3e8fb0">for</span> <span style="color:#ea9a97">f</span> <span style="color:#908caa">in</span> <span style="color:#ea9a97">database</span><span style="color:#908caa">.</span><span style="color:#ea9a97">columns</span> <span style="color:#3e8fb0">if</span> <span style="color:#ea9a97">database</span><span style="color:#908caa">.</span><span style="color:#ea9a97">dtypes</span><span style="color:#908caa">[</span><span style="color:#ea9a97">f</span><span style="color:#908caa">]</span> <span style="color:#908caa">==</span> <span style="color:#f6c177">&#39;object&#39;</span><span style="color:#908caa">]</span>
</span></span></code></pre></div><p>The columns with missing values are determined as follows:</p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ea9a97">Index</span><span style="color:#908caa">([</span><span style="color:#908caa">**</span><span style="color:#f6c177">&#39;TotalBsmtSF&#39;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#39;GarageArea&#39;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#39;GarageCars&#39;</span><span style="color:#908caa">**</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#39;KitchenQual&#39;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#39;Electrical&#39;</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>       <span style="color:#908caa">**</span><span style="color:#f6c177">&#39;BsmtUnfSF&#39;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#39;BsmtFinSF2&#39;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#39;BsmtFinSF1&#39;</span><span style="color:#908caa">**</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#39;SaleType&#39;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#39;Exterior1st&#39;</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>       <span style="color:#f6c177">&#39;Exterior2nd&#39;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#39;Functional&#39;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#39;Utilities&#39;</span><span style="color:#908caa">,</span> <span style="color:#908caa">**</span><span style="color:#f6c177">&#39;BsmtHalfBath&#39;</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>       <span style="color:#f6c177">&#39;BsmtFullBath&#39;</span><span style="color:#908caa">**</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#39;MSZoning&#39;</span><span style="color:#908caa">,</span> <span style="color:#908caa">**</span><span style="color:#f6c177">&#39;MasVnrArea&#39;</span><span style="color:#908caa">**</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#39;**MasVnrType&#39;</span><span style="color:#908caa">**</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#39;**BsmtFinType1**&#39;</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>       <span style="color:#f6c177">&#39;**BsmtFinType2**&#39;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#39;**BsmtQual**&#39;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#39;**BsmtCond**&#39;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#39;**BsmtExposure**&#39;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#39;**GarageType**&#39;</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>       <span style="color:#f6c177">&#39;**GarageCond**&#39;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#39;**GarageQual**&#39;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#39;**GarageYrBlt**&#39;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#39;**GarageFinish**&#39;</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>       <span style="color:#f6c177">&#39;LotFrontage&#39;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#39;**FireplaceQu**&#39;</span><span style="color:#908caa">,</span> <span style="color:#908caa">**</span><span style="color:#f6c177">&#39;Fence&#39;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#39;Alley**&#39;</span><span style="color:#908caa">,</span> <span style="color:#908caa">**</span><span style="color:#f6c177">&#39;MiscFeature&#39;</span><span style="color:#908caa">**</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>       <span style="color:#f6c177">&#39;**PoolQC**&#39;</span><span style="color:#908caa">]</span>
</span></span></code></pre></div><p>For some features, &lsquo;NA&rsquo; represents the absence of the feature itself, but pandas will identify it as missing data. For these &lsquo;object_type&rsquo; features, they should be replaced with type-&lsquo;None&rsquo;, while &rsquo;numerical_type&rsquo; features should be filled with zeros. For example, &lsquo;NA&rsquo; values in &lsquo;Pool QC&rsquo; (Pool Quality) represent the absence of a swimming pool, so they should be replaced with &lsquo;None&rsquo;. For other missing values in &lsquo;object_type&rsquo; features, they should be filled with the mode of that column, while for &rsquo;numerical_type&rsquo; features, they should be filled with the mean of that column.</p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ea9a97">non</span><span style="color:#908caa">=</span><span style="color:#908caa">[</span><span style="color:#f6c177">&#39;PoolQC&#39;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#39;MiscFeature&#39;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#39;Alley&#39;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#39;Fence&#39;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#39;FireplaceQu&#39;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#39;GarageCond&#39;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#39;GarageQual&#39;</span><span style="color:#908caa">,</span> 
</span></span><span style="display:flex;"><span>     <span style="color:#f6c177">&#39;GarageFinish&#39;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#39;GarageType&#39;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#39;BsmtCond&#39;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#39;BsmtExposure&#39;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#39;BsmtQual&#39;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#39;BsmtFinType1&#39;</span><span style="color:#908caa">,</span> 
</span></span><span style="display:flex;"><span>     <span style="color:#f6c177">&#39;BsmtFinType2&#39;</span><span style="color:#908caa">,</span><span style="color:#f6c177">&#39;MasVnrType&#39;</span><span style="color:#908caa">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">zerof</span><span style="color:#908caa">=</span><span style="color:#908caa">[</span><span style="color:#f6c177">&#39;TotalBsmtSF&#39;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#39;GarageArea&#39;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#39;GarageCars&#39;</span><span style="color:#908caa">,</span><span style="color:#f6c177">&#39;BsmtUnfSF&#39;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#39;BsmtFinSF2&#39;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#39;BsmtFinSF1&#39;</span><span style="color:#908caa">,</span><span style="color:#f6c177">&#39;BsmtHalfBath&#39;</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>       <span style="color:#f6c177">&#39;BsmtFullBath&#39;</span><span style="color:#908caa">,</span><span style="color:#f6c177">&#39;MasVnrArea&#39;</span><span style="color:#908caa">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">needfill</span><span style="color:#908caa">=</span><span style="color:#908caa">[</span><span style="color:#f6c177">&#39;KitchenQual&#39;</span><span style="color:#908caa">,</span><span style="color:#f6c177">&#39;Electrical&#39;</span><span style="color:#908caa">,</span><span style="color:#f6c177">&#39;SaleType&#39;</span><span style="color:#908caa">,</span><span style="color:#f6c177">&#39;Exterior1st&#39;</span><span style="color:#908caa">,</span><span style="color:#f6c177">&#39;Exterior2nd&#39;</span><span style="color:#908caa">,</span><span style="color:#f6c177">&#39;Functional&#39;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#39;Utilities&#39;</span><span style="color:#908caa">,</span><span style="color:#f6c177">&#39;MSZoning&#39;</span><span style="color:#908caa">]</span><span style="color:#6e6a86">#front: numerical_type_feature backw: objective_type_feature</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">front</span><span style="color:#908caa">=</span><span style="color:#ea9a97">database</span><span style="color:#908caa">[</span><span style="color:#ea9a97">quant</span><span style="color:#908caa">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">front</span><span style="color:#908caa">[</span><span style="color:#ea9a97">zerof</span><span style="color:#908caa">]</span><span style="color:#908caa">=</span><span style="color:#ea9a97">front</span><span style="color:#908caa">[</span><span style="color:#ea9a97">zerof</span><span style="color:#908caa">]</span><span style="color:#908caa">.</span><span style="color:#ea9a97">fillna</span><span style="color:#908caa">(</span><span style="color:#f6c177">0</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">front</span><span style="color:#908caa">[</span><span style="color:#f6c177">&#39;LotFrontage&#39;</span><span style="color:#908caa">]</span><span style="color:#908caa">=</span><span style="color:#ea9a97">front</span><span style="color:#908caa">[</span><span style="color:#f6c177">&#39;LotFrontage&#39;</span><span style="color:#908caa">]</span><span style="color:#908caa">.</span><span style="color:#ea9a97">fillna</span><span style="color:#908caa">(</span><span style="color:#ea9a97">front</span><span style="color:#908caa">[</span><span style="color:#f6c177">&#39;LotFrontage&#39;</span><span style="color:#908caa">]</span><span style="color:#908caa">.</span><span style="color:#ea9a97">mean</span><span style="color:#908caa">())</span><span style="color:#ea9a97">backw</span><span style="color:#908caa">=</span><span style="color:#ea9a97">database</span><span style="color:#908caa">[</span><span style="color:#ea9a97">quali</span><span style="color:#908caa">]</span>
</span></span><span style="display:flex;"><span><span style="color:#3e8fb0">for</span> <span style="color:#ea9a97">x</span> <span style="color:#908caa">in</span> <span style="color:#ea9a97">needfill</span><span style="color:#908caa">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">backw</span><span style="color:#908caa">[</span><span style="color:#ea9a97">x</span><span style="color:#908caa">]</span><span style="color:#908caa">=</span><span style="color:#ea9a97">backw</span><span style="color:#908caa">[</span><span style="color:#ea9a97">x</span><span style="color:#908caa">]</span><span style="color:#908caa">.</span><span style="color:#ea9a97">fillna</span><span style="color:#908caa">(</span><span style="color:#ea9a97">backw</span><span style="color:#908caa">[</span><span style="color:#ea9a97">x</span><span style="color:#908caa">]</span><span style="color:#908caa">.</span><span style="color:#ea9a97">mode</span><span style="color:#908caa">()[</span><span style="color:#f6c177">0</span><span style="color:#908caa">])</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">backw</span><span style="color:#908caa">[</span><span style="color:#ea9a97">non</span><span style="color:#908caa">]</span><span style="color:#908caa">=</span><span style="color:#ea9a97">backw</span><span style="color:#908caa">[</span><span style="color:#ea9a97">non</span><span style="color:#908caa">]</span><span style="color:#908caa">.</span><span style="color:#ea9a97">fillna</span><span style="color:#908caa">(</span><span style="color:#f6c177">&#39;None&#39;</span><span style="color:#908caa">)</span>
</span></span></code></pre></div><h1 id="data-visualization">Data Visualization：</h1>
<h2 id="distribution-of-numerical_type_feature">Distribution of ‘numerical_type_feature’</h2>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ea9a97">c</span><span style="color:#908caa">=</span> <span style="color:#908caa">[</span><span style="color:#ea9a97">f</span> <span style="color:#3e8fb0">for</span> <span style="color:#ea9a97">f</span> <span style="color:#908caa">in</span> <span style="color:#ea9a97">database</span><span style="color:#908caa">.</span><span style="color:#ea9a97">columns</span> <span style="color:#3e8fb0">if</span> <span style="color:#ea9a97">database</span><span style="color:#908caa">.</span><span style="color:#ea9a97">dtypes</span><span style="color:#908caa">[</span><span style="color:#ea9a97">f</span><span style="color:#908caa">]</span> <span style="color:#908caa">!=</span> <span style="color:#f6c177">&#39;object&#39;</span><span style="color:#908caa">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">c</span><span style="color:#908caa">.</span><span style="color:#ea9a97">remove</span><span style="color:#908caa">(</span><span style="color:#f6c177">&#39;Id&#39;</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">f</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">pd</span><span style="color:#908caa">.</span><span style="color:#ea9a97">melt</span><span style="color:#908caa">(</span><span style="color:#ea9a97">front</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">value_vars</span><span style="color:#908caa">=</span><span style="color:#ea9a97">c</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">g</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">sns</span><span style="color:#908caa">.</span><span style="color:#ea9a97">FacetGrid</span><span style="color:#908caa">(</span><span style="color:#ea9a97">f</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">col</span><span style="color:#908caa">=</span><span style="color:#f6c177">&#34;variable&#34;</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">col_wrap</span><span style="color:#908caa">=</span><span style="color:#f6c177">4</span> <span style="color:#908caa">,</span> <span style="color:#ea9a97">sharex</span><span style="color:#908caa">=</span><span style="color:#3e8fb0">False</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">sharey</span><span style="color:#908caa">=</span><span style="color:#3e8fb0">False</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">g</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">g</span><span style="color:#908caa">.</span><span style="color:#ea9a97">map</span><span style="color:#908caa">(</span><span style="color:#ea9a97">sns</span><span style="color:#908caa">.</span><span style="color:#ea9a97">distplot</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;value&#34;</span><span style="color:#908caa">)</span>
</span></span></code></pre></div><p><img src="https://miro.medium.com/max/1400/1*vlmo1EpoUCU7r1NNva8grA.png" alt="img"></p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ea9a97">logtran</span><span style="color:#908caa">=</span><span style="color:#908caa">[</span><span style="color:#f6c177">&#39;LotFrontage&#39;</span><span style="color:#908caa">,</span><span style="color:#f6c177">&#39;LotArea&#39;</span><span style="color:#908caa">,</span><span style="color:#f6c177">&#39;1stFlrSF&#39;</span><span style="color:#908caa">,</span><span style="color:#f6c177">&#39;GrLivArea&#39;</span><span style="color:#908caa">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">front</span><span style="color:#908caa">[</span><span style="color:#ea9a97">logtran</span><span style="color:#908caa">]</span><span style="color:#908caa">=</span><span style="color:#ea9a97">np</span><span style="color:#908caa">.</span><span style="color:#ea9a97">log</span><span style="color:#908caa">(</span><span style="color:#ea9a97">front</span><span style="color:#908caa">[</span><span style="color:#ea9a97">logtran</span><span style="color:#908caa">])</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">front</span><span style="color:#908caa">=</span><span style="color:#908caa">(</span><span style="color:#ea9a97">front</span><span style="color:#908caa">-</span><span style="color:#ea9a97">front</span><span style="color:#908caa">.</span><span style="color:#ea9a97">mean</span><span style="color:#908caa">())</span><span style="color:#908caa">/</span><span style="color:#908caa">(</span><span style="color:#ea9a97">front</span><span style="color:#908caa">.</span><span style="color:#ea9a97">std</span><span style="color:#908caa">())</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ea9a97">y</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">train</span><span style="color:#908caa">[</span><span style="color:#f6c177">&#39;SalePrice&#39;</span><span style="color:#908caa">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">plt</span><span style="color:#908caa">.</span><span style="color:#ea9a97">figure</span><span style="color:#908caa">(</span><span style="color:#f6c177">2</span><span style="color:#908caa">);</span> <span style="color:#ea9a97">plt</span><span style="color:#908caa">.</span><span style="color:#ea9a97">title</span><span style="color:#908caa">(</span><span style="color:#f6c177">&#39;Normal&#39;</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">sns</span><span style="color:#908caa">.</span><span style="color:#ea9a97">distplot</span><span style="color:#908caa">(</span><span style="color:#ea9a97">y</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">kde</span><span style="color:#908caa">=</span><span style="color:#3e8fb0">False</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">fit</span><span style="color:#908caa">=</span><span style="color:#ea9a97">stats</span><span style="color:#908caa">.</span><span style="color:#ea9a97">norm</span><span style="color:#908caa">)</span> 
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">plt</span><span style="color:#908caa">.</span><span style="color:#ea9a97">figure</span><span style="color:#908caa">(</span><span style="color:#f6c177">3</span><span style="color:#908caa">);</span> <span style="color:#ea9a97">plt</span><span style="color:#908caa">.</span><span style="color:#ea9a97">title</span><span style="color:#908caa">(</span><span style="color:#f6c177">&#39;Log Normal&#39;</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">sns</span><span style="color:#908caa">.</span><span style="color:#ea9a97">distplot</span><span style="color:#908caa">(</span><span style="color:#ea9a97">y</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">kde</span><span style="color:#908caa">=</span><span style="color:#3e8fb0">False</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">fit</span><span style="color:#908caa">=</span><span style="color:#ea9a97">stats</span><span style="color:#908caa">.</span><span style="color:#ea9a97">lognorm</span><span style="color:#908caa">)</span><span style="color:#ea9a97">trainresult</span><span style="color:#908caa">=</span><span style="color:#ea9a97">np</span><span style="color:#908caa">.</span><span style="color:#ea9a97">log</span><span style="color:#908caa">(</span><span style="color:#ea9a97">data</span><span style="color:#908caa">[</span><span style="color:#f6c177">&#39;SalePrice&#39;</span><span style="color:#908caa">])</span>
</span></span></code></pre></div><p><img src="https://miro.medium.com/max/724/1*ABH4hgsjtZ55lBsqR6Ow3w.png" alt="img">
In these distribution plots, we can see that the distributions of &lsquo;LotFrontage&rsquo;, &lsquo;LotArea&rsquo;, &lsquo;1stFlrSF&rsquo;, and &lsquo;GrLivArea&rsquo; are closer to log-normal distribution. Therefore, we can take the logarithm of these columns to make the data distribution closer to normal distribution. Then, we normalize all &rsquo;numerical_type&rsquo; features.</p>
<p>In addition, the values of &lsquo;BsmtFinSF2&rsquo;, &lsquo;LowQualFinSF&rsquo;, &lsquo;BsmtHalfBath&rsquo;, &lsquo;KitchenAbvGr&rsquo;, &lsquo;EnclosedPorch&rsquo;, &lsquo;3SsnPorch&rsquo;, &lsquo;ScreenPorch&rsquo;, &lsquo;PoolArea&rsquo;, and &lsquo;MiscVal&rsquo; are highly concentrated and cannot provide useful information. Therefore, they can be added to the list of columns to be removed.</p>
<h2 id="heatmap-of-the-correlation-between-numerical-features-and-sale_price">Heatmap of the correlation between numerical features and Sale_Price:</h2>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ea9a97">plt</span><span style="color:#908caa">.</span><span style="color:#ea9a97">figure</span><span style="color:#908caa">(</span><span style="color:#ea9a97">figsize</span><span style="color:#908caa">=</span><span style="color:#908caa">(</span><span style="color:#f6c177">16</span><span style="color:#908caa">,</span> <span style="color:#f6c177">16</span><span style="color:#908caa">))</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">front</span><span style="color:#908caa">=</span><span style="color:#ea9a97">front</span><span style="color:#908caa">.</span><span style="color:#ea9a97">drop</span><span style="color:#908caa">(</span><span style="color:#f6c177">&#39;Id&#39;</span><span style="color:#908caa">,</span><span style="color:#ea9a97">axis</span><span style="color:#908caa">=</span><span style="color:#f6c177">1</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">front</span><span style="color:#908caa">[</span><span style="color:#f6c177">&#39;SalePrice&#39;</span><span style="color:#908caa">]</span><span style="color:#908caa">=</span><span style="color:#ea9a97">np</span><span style="color:#908caa">.</span><span style="color:#ea9a97">log</span><span style="color:#908caa">(</span><span style="color:#ea9a97">train</span><span style="color:#908caa">[</span><span style="color:#f6c177">&#39;SalePrice&#39;</span><span style="color:#908caa">])</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">corr</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">front</span><span style="color:#908caa">.</span><span style="color:#ea9a97">corr</span><span style="color:#908caa">()</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">sns</span><span style="color:#908caa">.</span><span style="color:#ea9a97">heatmap</span><span style="color:#908caa">(</span><span style="color:#ea9a97">corr</span><span style="color:#908caa">,</span><span style="color:#ea9a97">cmap</span><span style="color:#908caa">=</span><span style="color:#f6c177">&#34;viridis&#34;</span><span style="color:#908caa">)</span>
</span></span></code></pre></div><p><img src="https://miro.medium.com/max/1400/1*L-yJNr8WE0gYGKOgVJR2Aw.png" alt="img"></p>
<p>According to the above heatmap of the correlation between numerical features and Sale_Price, we can see strong correlations between TotalBsmt and 1stFlrSF, and between garage_area and garage_car. This can be inferred from the fact that the total area of the basement and the first floor is mostly the same, and that the larger the garage area, the more garage cars there will be.</p>
<p>In addition, OverallQual, GrLivArea, and Sale_Price have a relatively high correlation, suggesting that OverallQual and GrLivArea may be important features with a higher weight during training.</p>
<p>As for the unimportant features (with very dim colors), they include BsmtFinSF2, LowQualFinSF, BsmtHalfBath, KitchenAbvGr, EnclosedPorch, 3SsnPorch, ScreenPorch, PoolArea, MiscVal, etc. These are the features mentioned earlier that have a very concentrated and singular distribution.</p>
<p>MoSold and YrSold also do not seem to be very important, indicating that the time of sale does not have a significant impact on house prices.</p>
<p>Next, we will perform one-hot coding on the object_type features, and then combine them with the numerical_type features into a single dataframe. We will then remove the unimportant features based on the data visualization results.</p>
<p>Furthermore, some of the object_type features have &ldquo;None&rdquo; values that refer to the same thing. For example, if a house has no garage in a transaction, then &lsquo;GarageCond&rsquo;, &lsquo;GarageQual&rsquo;, &lsquo;GarageFinish&rsquo;, and &lsquo;GarageType&rsquo; will all be &lsquo;None&rsquo;. After one-hot coding, this will result in &lsquo;GarageCond_None&rsquo;, &lsquo;GarageQual_None&rsquo;, &lsquo;GarageFinish_None&rsquo;, &lsquo;GarageType_None&rsquo;, etc., and the values of these features will all be 1 for that transaction. If the house has a garage, the values will be 0 for all these features. Therefore, we only need to keep one feature.</p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ea9a97">backw</span><span style="color:#908caa">=</span><span style="color:#ea9a97">pd</span><span style="color:#908caa">.</span><span style="color:#ea9a97">get_dummies</span><span style="color:#908caa">(</span><span style="color:#ea9a97">backw</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">databass</span><span style="color:#908caa">=</span><span style="color:#ea9a97">pd</span><span style="color:#908caa">.</span><span style="color:#ea9a97">concat</span><span style="color:#908caa">([</span><span style="color:#ea9a97">front</span><span style="color:#908caa">,</span><span style="color:#ea9a97">backw</span><span style="color:#908caa">],</span><span style="color:#ea9a97">axis</span><span style="color:#908caa">=</span><span style="color:#f6c177">1</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">delete_feature</span><span style="color:#908caa">=</span><span style="color:#908caa">[</span><span style="color:#f6c177">&#39;MoSold&#39;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#39;YrSold&#39;</span><span style="color:#908caa">,</span><span style="color:#f6c177">&#39;Id&#39;</span><span style="color:#908caa">,</span><span style="color:#f6c177">&#39;BsmtHalfBath&#39;</span><span style="color:#908caa">,</span>  
</span></span><span style="display:flex;"><span>                <span style="color:#f6c177">&#39;KitchenAbvGr&#39;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#39;EnclosedPorch&#39;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#39;3SsnPorch&#39;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#39;ScreenPorch&#39;</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f6c177">&#39;PoolArea&#39;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#39;MiscVal&#39;</span><span style="color:#908caa">,</span><span style="color:#f6c177">&#39;1stFlrSF&#39;</span><span style="color:#908caa">,</span><span style="color:#f6c177">&#39;GarageArea&#39;</span><span style="color:#908caa">,</span><span style="color:#f6c177">&#39;LowQualFinSF&#39;</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>								<span style="color:#f6c177">&#39;BsmtFinSF2&#39;</span><span style="color:#908caa">,</span><span style="color:#f6c177">&#39;GarageYrBlt&#39;</span><span style="color:#908caa">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">repeatnon</span><span style="color:#908caa">=</span><span style="color:#908caa">[</span> <span style="color:#f6c177">&#39;GarageCond_None&#39;</span><span style="color:#908caa">,</span><span style="color:#f6c177">&#39;GarageQual_None&#39;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#39;GarageFinish_None&#39;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#39;GarageType_None&#39;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#39;BsmtCond_None&#39;</span><span style="color:#908caa">,</span><span style="color:#f6c177">&#39;BsmtExposure_None&#39;</span><span style="color:#908caa">,</span> 
</span></span><span style="display:flex;"><span>           <span style="color:#f6c177">&#39;BsmtQual_None&#39;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#39;BsmtFinType1_None&#39;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#39;BsmtFinType2_None&#39;</span><span style="color:#908caa">,</span><span style="color:#f6c177">&#39;MasVnrType_None&#39;</span><span style="color:#908caa">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">databass</span><span style="color:#908caa">=</span><span style="color:#ea9a97">databass</span><span style="color:#908caa">.</span><span style="color:#ea9a97">drop</span><span style="color:#908caa">(</span><span style="color:#ea9a97">delete_feature</span><span style="color:#908caa">,</span><span style="color:#ea9a97">axis</span><span style="color:#908caa">=</span><span style="color:#f6c177">1</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">databass</span><span style="color:#908caa">=</span><span style="color:#ea9a97">databass</span><span style="color:#908caa">.</span><span style="color:#ea9a97">drop</span><span style="color:#908caa">(</span><span style="color:#ea9a97">repeatnon</span><span style="color:#908caa">,</span><span style="color:#ea9a97">axis</span><span style="color:#908caa">=</span><span style="color:#f6c177">1</span><span style="color:#908caa">)</span>
</span></span></code></pre></div><h1 id="numerical_type_feature對sale-price的scatter-plot">‘numerical_type_feature’對Sale-Price的scatter plot</h1>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#3e8fb0">def</span> <span style="color:#ea9a97">scatter</span><span style="color:#908caa">(</span><span style="color:#ea9a97">x</span><span style="color:#908caa">,</span><span style="color:#ea9a97">y</span><span style="color:#908caa">,</span><span style="color:#908caa">**</span><span style="color:#ea9a97">kwargs</span><span style="color:#908caa">):</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">sns</span><span style="color:#908caa">.</span><span style="color:#ea9a97">scatterplot</span><span style="color:#908caa">(</span><span style="color:#ea9a97">x</span><span style="color:#908caa">,</span><span style="color:#ea9a97">y</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">c</span><span style="color:#908caa">=</span> <span style="color:#908caa">[</span><span style="color:#ea9a97">f</span> <span style="color:#3e8fb0">for</span> <span style="color:#ea9a97">f</span> <span style="color:#908caa">in</span> <span style="color:#ea9a97">database</span><span style="color:#908caa">.</span><span style="color:#ea9a97">columns</span> <span style="color:#3e8fb0">if</span> <span style="color:#ea9a97">database</span><span style="color:#908caa">.</span><span style="color:#ea9a97">dtypes</span><span style="color:#908caa">[</span><span style="color:#ea9a97">f</span><span style="color:#908caa">]</span> <span style="color:#908caa">!=</span> <span style="color:#f6c177">&#39;object&#39;</span><span style="color:#908caa">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">c</span><span style="color:#908caa">.</span><span style="color:#ea9a97">remove</span><span style="color:#908caa">(</span><span style="color:#f6c177">&#39;Id&#39;</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">front</span><span style="color:#908caa">[</span><span style="color:#f6c177">&#39;SalePrice&#39;</span><span style="color:#908caa">]</span><span style="color:#908caa">=</span><span style="color:#ea9a97">train</span><span style="color:#908caa">[</span><span style="color:#f6c177">&#39;SalePrice&#39;</span><span style="color:#908caa">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">f</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">pd</span><span style="color:#908caa">.</span><span style="color:#ea9a97">melt</span><span style="color:#908caa">(</span><span style="color:#ea9a97">front</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">id_vars</span><span style="color:#908caa">=</span><span style="color:#908caa">[</span><span style="color:#f6c177">&#39;SalePrice&#39;</span><span style="color:#908caa">],</span><span style="color:#ea9a97">value_vars</span><span style="color:#908caa">=</span><span style="color:#ea9a97">c</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">g</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">sns</span><span style="color:#908caa">.</span><span style="color:#ea9a97">FacetGrid</span><span style="color:#908caa">(</span><span style="color:#ea9a97">f</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">col</span><span style="color:#908caa">=</span><span style="color:#f6c177">&#34;variable&#34;</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">col_wrap</span><span style="color:#908caa">=</span><span style="color:#f6c177">4</span> <span style="color:#908caa">,</span> <span style="color:#ea9a97">sharex</span><span style="color:#908caa">=</span><span style="color:#3e8fb0">False</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">sharey</span><span style="color:#908caa">=</span><span style="color:#3e8fb0">False</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">g</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">g</span><span style="color:#908caa">.</span><span style="color:#ea9a97">map</span><span style="color:#908caa">(</span><span style="color:#ea9a97">scatter</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;value&#34;</span><span style="color:#908caa">,</span><span style="color:#f6c177">&#39;SalePrice&#39;</span><span style="color:#908caa">)</span>
</span></span></code></pre></div><p><img src="https://miro.medium.com/max/1400/1*CoChDISZu8D_eg-rrn1gkA.png" alt="img"></p>
<p>From the above plots, we can observe the potentially important features identified earlier: &lsquo;OverallQual&rsquo; and &lsquo;GrLivArea&rsquo;. It can be seen that there are two outliers with low SalePrice values when &lsquo;OverallQual&rsquo; is at its maximum, and the same situation can also be observed for &lsquo;GrLivArea&rsquo;. The indices of these two points are 523 and 1298, and they clearly deviate from the trend of other points, which is not consistent with common sense. These outliers should be removed.</p>
<h1 id="use-lasso-for-feature-selection">Use Lasso for feature selection:</h1>
<p>Lasso is a linear model that uses a penalty term to perform regularization, with the coefficients of unimportant features becoming zero after training. It is commonly used for feature selection. In addition, during training, the best penalty coefficient can be found using GridSearchCV to create the most accurate model that can determine the importance of features and retain only those with coefficients greater than zero.</p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#6e6a86">#feature_selection by Lasso()</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">pipeline</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">Pipeline</span><span style="color:#908caa">([(</span><span style="color:#f6c177">&#39;scaler&#39;</span><span style="color:#908caa">,</span><span style="color:#ea9a97">StandardScaler</span><span style="color:#908caa">()),(</span><span style="color:#f6c177">&#39;model&#39;</span><span style="color:#908caa">,</span><span style="color:#ea9a97">Lasso</span><span style="color:#908caa">())])</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">search</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">GridSearchCV</span><span style="color:#908caa">(</span><span style="color:#ea9a97">pipeline</span><span style="color:#908caa">,{</span><span style="color:#f6c177">&#39;model__alpha&#39;</span><span style="color:#908caa">:</span><span style="color:#ea9a97">np</span><span style="color:#908caa">.</span><span style="color:#ea9a97">arange</span><span style="color:#908caa">(</span><span style="color:#f6c177">1e-3</span><span style="color:#908caa">,</span><span style="color:#f6c177">1e-2</span><span style="color:#908caa">,</span><span style="color:#f6c177">1e-4</span><span style="color:#908caa">)},</span>
</span></span><span style="display:flex;"><span>                      <span style="color:#ea9a97">cv</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">5</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">scoring</span><span style="color:#908caa">=</span><span style="color:#f6c177">&#34;neg_mean_squared_error&#34;</span><span style="color:#908caa">,</span><span style="color:#ea9a97">verbose</span><span style="color:#908caa">=</span><span style="color:#f6c177">5</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">search</span><span style="color:#908caa">.</span><span style="color:#ea9a97">fit</span><span style="color:#908caa">(</span><span style="color:#ea9a97">databass</span><span style="color:#908caa">.</span><span style="color:#ea9a97">iloc</span><span style="color:#908caa">[:</span><span style="color:#f6c177">1458</span><span style="color:#908caa">],</span> <span style="color:#ea9a97">trainresult</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">print</span><span style="color:#908caa">(</span><span style="color:#ea9a97">search</span><span style="color:#908caa">.</span><span style="color:#ea9a97">best_params_</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">coefficients</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">search</span><span style="color:#908caa">.</span><span style="color:#ea9a97">best_estimator_</span><span style="color:#908caa">.</span><span style="color:#ea9a97">named_steps</span><span style="color:#908caa">[</span><span style="color:#f6c177">&#39;model&#39;</span><span style="color:#908caa">]</span><span style="color:#908caa">.</span><span style="color:#ea9a97">coef_</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">importance</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">np</span><span style="color:#908caa">.</span><span style="color:#ea9a97">abs</span><span style="color:#908caa">(</span><span style="color:#ea9a97">coefficients</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">feature</span><span style="color:#908caa">=</span><span style="color:#ea9a97">databass</span><span style="color:#908caa">.</span><span style="color:#ea9a97">columns</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">evaluate</span><span style="color:#908caa">=</span><span style="color:#ea9a97">pd</span><span style="color:#908caa">.</span><span style="color:#ea9a97">DataFrame</span><span style="color:#908caa">({</span><span style="color:#f6c177">&#39;feature&#39;</span><span style="color:#908caa">:</span><span style="color:#ea9a97">feature</span><span style="color:#908caa">,</span><span style="color:#f6c177">&#39;importance&#39;</span><span style="color:#908caa">:</span><span style="color:#ea9a97">importance</span><span style="color:#908caa">})</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">drop</span><span style="color:#908caa">=</span><span style="color:#ea9a97">evaluate</span><span style="color:#908caa">[</span><span style="color:#ea9a97">evaluate</span><span style="color:#908caa">[</span><span style="color:#f6c177">&#39;importance&#39;</span><span style="color:#908caa">]</span><span style="color:#908caa">==</span><span style="color:#f6c177">0</span><span style="color:#908caa">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">databass</span><span style="color:#908caa">=</span><span style="color:#ea9a97">databass</span><span style="color:#908caa">.</span><span style="color:#ea9a97">drop</span><span style="color:#908caa">(</span><span style="color:#ea9a97">drop</span><span style="color:#908caa">[</span><span style="color:#f6c177">&#39;feature&#39;</span><span style="color:#908caa">],</span><span style="color:#ea9a97">axis</span><span style="color:#908caa">=</span><span style="color:#f6c177">1</span><span style="color:#908caa">)</span>
</span></span></code></pre></div><h1 id="training-process">Training Process:</h1>
<p>In the training process, I used a total of four linear models (Ridge, Lasso, Elastic Net, SVM Regressor) and two boosting models (Gradient Boosting, XGB), and also used the aforementioned six models as the first-stage regressors, and the XGB algorithm as the second-stage meta-regressor for stacking. Then, the stacking model and other models were blended together.</p>
<p>I separated the training and testing data again and defined the &ldquo;cv_rmse_function&rdquo; to prepare for evaluating the performance of each model using 10-fold cross-validation.</p>
<p><img src="https://miro.medium.com/max/1400/1*CoChDISZu8D_eg-rrn1gkA.png" alt="img"></p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ea9a97">trainfeature</span><span style="color:#908caa">=</span><span style="color:#ea9a97">databass</span><span style="color:#908caa">[:</span><span style="color:#f6c177">1458</span><span style="color:#908caa">]</span> <span style="color:#6e6a86">#2 outlier removed</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">testfeature</span><span style="color:#908caa">=</span><span style="color:#ea9a97">databass</span><span style="color:#908caa">[</span><span style="color:#f6c177">1458</span><span style="color:#908caa">:]</span>
</span></span><span style="display:flex;"><span><span style="color:#6e6a86">#define functions in training process</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">kfolds</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">KFold</span><span style="color:#908caa">(</span><span style="color:#ea9a97">n_splits</span><span style="color:#908caa">=</span><span style="color:#f6c177">10</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">shuffle</span><span style="color:#908caa">=</span><span style="color:#3e8fb0">True</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">random_state</span><span style="color:#908caa">=</span><span style="color:#f6c177">42</span><span style="color:#908caa">)</span><span style="color:#3e8fb0">def</span> <span style="color:#ea9a97">cv_rmse</span><span style="color:#908caa">(</span><span style="color:#ea9a97">model</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">X</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">y</span><span style="color:#908caa">):</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ea9a97">rmse</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">np</span><span style="color:#908caa">.</span><span style="color:#ea9a97">sqrt</span><span style="color:#908caa">(</span><span style="color:#908caa">-</span><span style="color:#ea9a97">cross_val_score</span><span style="color:#908caa">(</span><span style="color:#ea9a97">model</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">X</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">y</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">scoring</span><span style="color:#908caa">=</span><span style="color:#f6c177">&#34;neg_mean_squared_error&#34;</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>									 <span style="color:#ea9a97">cv</span><span style="color:#908caa">=</span><span style="color:#ea9a97">kfolds</span><span style="color:#908caa">))</span>
</span></span><span style="display:flex;"><span>    <span style="color:#3e8fb0">return</span> <span style="color:#908caa">(</span><span style="color:#ea9a97">rmse</span><span style="color:#908caa">)</span>
</span></span></code></pre></div><p>Set the parameter values for the six models and use RobustScaler() to reduce the impact of outliers on the training process for the linear models. Also, use stacking with first stage regressors including ridge, lasso, elastic net, SVM regressor, gradient boosting regressor, and XGBoost regressor, and a meta regressor of XGBoost regressor.</p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ea9a97">alphas_alt</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">np</span><span style="color:#908caa">.</span><span style="color:#ea9a97">arange</span><span style="color:#908caa">(</span><span style="color:#f6c177">14</span><span style="color:#908caa">,</span><span style="color:#f6c177">16</span><span style="color:#908caa">,</span><span style="color:#f6c177">0.1</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">alphas2</span> <span style="color:#908caa">=</span> <span style="color:#908caa">[</span><span style="color:#f6c177">0.003</span><span style="color:#908caa">,</span> <span style="color:#f6c177">0.004</span><span style="color:#908caa">,</span> <span style="color:#f6c177">0.005</span><span style="color:#908caa">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">e_alphas</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">np</span><span style="color:#908caa">.</span><span style="color:#ea9a97">arange</span><span style="color:#908caa">(</span><span style="color:#f6c177">1e-4</span><span style="color:#908caa">,</span><span style="color:#f6c177">1e-3</span><span style="color:#908caa">,</span><span style="color:#f6c177">1e-4</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">e_l1ratio</span> <span style="color:#908caa">=</span>  <span style="color:#ea9a97">np</span><span style="color:#908caa">.</span><span style="color:#ea9a97">arange</span><span style="color:#908caa">(</span><span style="color:#f6c177">0.8</span><span style="color:#908caa">,</span><span style="color:#f6c177">1</span><span style="color:#908caa">,</span><span style="color:#f6c177">0.25</span><span style="color:#908caa">)</span><span style="color:#ea9a97">ridge</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">make_pipeline</span><span style="color:#908caa">(</span><span style="color:#ea9a97">RobustScaler</span><span style="color:#908caa">(),</span> <span style="color:#ea9a97">RidgeCV</span><span style="color:#908caa">(</span><span style="color:#ea9a97">alphas</span><span style="color:#908caa">=</span><span style="color:#ea9a97">alphas_alt</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">cv</span><span style="color:#908caa">=</span><span style="color:#ea9a97">kfolds</span><span style="color:#908caa">))</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">lasso</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">make_pipeline</span><span style="color:#908caa">(</span><span style="color:#ea9a97">RobustScaler</span><span style="color:#908caa">(),</span> <span style="color:#ea9a97">LassoCV</span><span style="color:#908caa">(</span><span style="color:#ea9a97">max_iter</span><span style="color:#908caa">=</span><span style="color:#f6c177">1e7</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">alphas</span><span style="color:#908caa">=</span><span style="color:#ea9a97">alphas2</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">random_state</span><span style="color:#908caa">=</span><span style="color:#f6c177">42</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">cv</span><span style="color:#908caa">=</span><span style="color:#ea9a97">kfolds</span><span style="color:#908caa">))</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">elasticnet</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">make_pipeline</span><span style="color:#908caa">(</span><span style="color:#ea9a97">RobustScaler</span><span style="color:#908caa">(),</span> <span style="color:#ea9a97">ElasticNetCV</span><span style="color:#908caa">(</span><span style="color:#ea9a97">max_iter</span><span style="color:#908caa">=</span><span style="color:#f6c177">1e7</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">alphas</span><span style="color:#908caa">=</span><span style="color:#ea9a97">e_alphas</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">cv</span><span style="color:#908caa">=</span><span style="color:#ea9a97">kfolds</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">l1_ratio</span><span style="color:#908caa">=</span><span style="color:#ea9a97">e_l1ratio</span><span style="color:#908caa">))</span>                                
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">svr</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">make_pipeline</span><span style="color:#908caa">(</span><span style="color:#ea9a97">RobustScaler</span><span style="color:#908caa">(),</span> <span style="color:#ea9a97">SVR</span><span style="color:#908caa">(</span><span style="color:#ea9a97">C</span><span style="color:#908caa">=</span> <span style="color:#f6c177">20</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">epsilon</span><span style="color:#908caa">=</span> <span style="color:#f6c177">0.008</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">gamma</span><span style="color:#908caa">=</span><span style="color:#f6c177">0.0003</span><span style="color:#908caa">,))</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">xgbr</span><span style="color:#908caa">=</span> <span style="color:#ea9a97">xgb</span><span style="color:#908caa">.</span><span style="color:#ea9a97">XGBRegressor</span><span style="color:#908caa">(</span><span style="color:#ea9a97">learning_rate</span><span style="color:#908caa">=</span> <span style="color:#f6c177">0.01</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">max_depth</span><span style="color:#908caa">=</span> <span style="color:#f6c177">3</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">n_estimators</span><span style="color:#908caa">=</span> <span style="color:#f6c177">2500</span><span style="color:#908caa">,</span><span style="color:#ea9a97">objective</span><span style="color:#908caa">=</span><span style="color:#f6c177">&#39;reg:linear&#39;</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">gbr</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">GradientBoostingRegressor</span><span style="color:#908caa">(</span><span style="color:#ea9a97">n_estimators</span><span style="color:#908caa">=</span><span style="color:#f6c177">3000</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">learning_rate</span><span style="color:#908caa">=</span><span style="color:#f6c177">0.05</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">max_depth</span><span style="color:#908caa">=</span><span style="color:#f6c177">4</span><span style="color:#908caa">,</span> 
</span></span><span style="display:flex;"><span>                                <span style="color:#ea9a97">max_features</span><span style="color:#908caa">=</span><span style="color:#f6c177">&#39;sqrt&#39;</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">min_samples_leaf</span><span style="color:#908caa">=</span><span style="color:#f6c177">15</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">min_samples_split</span><span style="color:#908caa">=</span><span style="color:#f6c177">10</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">loss</span><span style="color:#908caa">=</span><span style="color:#f6c177">&#39;huber&#39;</span><span style="color:#908caa">,</span> 
</span></span><span style="display:flex;"><span>                                <span style="color:#ea9a97">random_state</span> <span style="color:#908caa">=</span><span style="color:#f6c177">42</span><span style="color:#908caa">)</span>                             
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">stackr</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">StackingCVRegressor</span><span style="color:#908caa">(</span><span style="color:#ea9a97">regressors</span><span style="color:#908caa">=</span><span style="color:#908caa">(</span><span style="color:#ea9a97">ridge</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">lasso</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">elasticnet</span><span style="color:#908caa">,</span><span style="color:#ea9a97">svr</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">gbr</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">xgbr</span><span style="color:#908caa">),</span>
</span></span><span style="display:flex;"><span>                             <span style="color:#ea9a97">meta_regressor</span><span style="color:#908caa">=</span><span style="color:#ea9a97">xgbr</span><span style="color:#908caa">,</span><span style="color:#ea9a97">use_features_in_secondary</span><span style="color:#908caa">=</span><span style="color:#3e8fb0">True</span><span style="color:#908caa">)</span>
</span></span></code></pre></div><p>Obtained the 10-fold cross validation error for each of the six models on the training data set and recorded them as a reference for the blending ratio in the later stage.</p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ea9a97">s</span><span style="color:#908caa">=</span><span style="color:#908caa">[]</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">score</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">cv_rmse</span><span style="color:#908caa">(</span><span style="color:#ea9a97">ridge</span><span style="color:#908caa">,</span><span style="color:#ea9a97">trainfeature</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">trainresult</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">s</span><span style="color:#908caa">.</span><span style="color:#ea9a97">append</span><span style="color:#908caa">(</span><span style="color:#f6c177">1</span><span style="color:#908caa">/</span><span style="color:#ea9a97">score</span><span style="color:#908caa">.</span><span style="color:#ea9a97">mean</span><span style="color:#908caa">())</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">print</span><span style="color:#908caa">(</span><span style="color:#f6c177">&#34;Ridge: </span><span style="color:#f6c177">{:.4f}</span><span style="color:#f6c177"> (</span><span style="color:#f6c177">{:.4f}</span><span style="color:#f6c177">)</span><span style="color:#3e8fb0">\\</span><span style="color:#f6c177">n&#34;</span><span style="color:#908caa">.</span><span style="color:#ea9a97">format</span><span style="color:#908caa">(</span><span style="color:#ea9a97">score</span><span style="color:#908caa">.</span><span style="color:#ea9a97">mean</span><span style="color:#908caa">(),</span> <span style="color:#ea9a97">score</span><span style="color:#908caa">.</span><span style="color:#ea9a97">std</span><span style="color:#908caa">())</span> <span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">score</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">cv_rmse</span><span style="color:#908caa">(</span><span style="color:#ea9a97">lasso</span><span style="color:#908caa">,</span><span style="color:#ea9a97">trainfeature</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">trainresult</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">s</span><span style="color:#908caa">.</span><span style="color:#ea9a97">append</span><span style="color:#908caa">(</span><span style="color:#f6c177">1</span><span style="color:#908caa">/</span><span style="color:#ea9a97">score</span><span style="color:#908caa">.</span><span style="color:#ea9a97">mean</span><span style="color:#908caa">())</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">print</span><span style="color:#908caa">(</span><span style="color:#f6c177">&#34;LASSO: </span><span style="color:#f6c177">{:.4f}</span><span style="color:#f6c177"> (</span><span style="color:#f6c177">{:.4f}</span><span style="color:#f6c177">)</span><span style="color:#3e8fb0">\\</span><span style="color:#f6c177">n&#34;</span><span style="color:#908caa">.</span><span style="color:#ea9a97">format</span><span style="color:#908caa">(</span><span style="color:#ea9a97">score</span><span style="color:#908caa">.</span><span style="color:#ea9a97">mean</span><span style="color:#908caa">(),</span> <span style="color:#ea9a97">score</span><span style="color:#908caa">.</span><span style="color:#ea9a97">std</span><span style="color:#908caa">()))</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">score</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">cv_rmse</span><span style="color:#908caa">(</span><span style="color:#ea9a97">elasticnet</span><span style="color:#908caa">,</span><span style="color:#ea9a97">trainfeature</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">trainresult</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">print</span><span style="color:#908caa">(</span><span style="color:#f6c177">&#34;elastic net: </span><span style="color:#f6c177">{:.4f}</span><span style="color:#f6c177"> (</span><span style="color:#f6c177">{:.4f}</span><span style="color:#f6c177">)</span><span style="color:#3e8fb0">\\</span><span style="color:#f6c177">n&#34;</span><span style="color:#908caa">.</span><span style="color:#ea9a97">format</span><span style="color:#908caa">(</span><span style="color:#ea9a97">score</span><span style="color:#908caa">.</span><span style="color:#ea9a97">mean</span><span style="color:#908caa">(),</span> <span style="color:#ea9a97">score</span><span style="color:#908caa">.</span><span style="color:#ea9a97">std</span><span style="color:#908caa">())</span> <span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">s</span><span style="color:#908caa">.</span><span style="color:#ea9a97">append</span><span style="color:#908caa">(</span><span style="color:#f6c177">1</span><span style="color:#908caa">/</span><span style="color:#ea9a97">score</span><span style="color:#908caa">.</span><span style="color:#ea9a97">mean</span><span style="color:#908caa">())</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">score</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">cv_rmse</span><span style="color:#908caa">(</span><span style="color:#ea9a97">svr</span><span style="color:#908caa">,</span><span style="color:#ea9a97">trainfeature</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">trainresult</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">print</span><span style="color:#908caa">(</span><span style="color:#f6c177">&#34;SVR: </span><span style="color:#f6c177">{:.4f}</span><span style="color:#f6c177"> (</span><span style="color:#f6c177">{:.4f}</span><span style="color:#f6c177">)</span><span style="color:#3e8fb0">\\</span><span style="color:#f6c177">n&#34;</span><span style="color:#908caa">.</span><span style="color:#ea9a97">format</span><span style="color:#908caa">(</span><span style="color:#ea9a97">score</span><span style="color:#908caa">.</span><span style="color:#ea9a97">mean</span><span style="color:#908caa">(),</span> <span style="color:#ea9a97">score</span><span style="color:#908caa">.</span><span style="color:#ea9a97">std</span><span style="color:#908caa">()))</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">s</span><span style="color:#908caa">.</span><span style="color:#ea9a97">append</span><span style="color:#908caa">(</span><span style="color:#f6c177">1</span><span style="color:#908caa">/</span><span style="color:#ea9a97">score</span><span style="color:#908caa">.</span><span style="color:#ea9a97">mean</span><span style="color:#908caa">())</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">score</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">cv_rmse</span><span style="color:#908caa">(</span><span style="color:#ea9a97">xgbr</span><span style="color:#908caa">,</span><span style="color:#ea9a97">trainfeature</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">trainresult</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">print</span><span style="color:#908caa">(</span><span style="color:#f6c177">&#34;xgboost: </span><span style="color:#f6c177">{:.4f}</span><span style="color:#f6c177"> (</span><span style="color:#f6c177">{:.4f}</span><span style="color:#f6c177">)</span><span style="color:#3e8fb0">\\</span><span style="color:#f6c177">n&#34;</span><span style="color:#908caa">.</span><span style="color:#ea9a97">format</span><span style="color:#908caa">(</span><span style="color:#ea9a97">score</span><span style="color:#908caa">.</span><span style="color:#ea9a97">mean</span><span style="color:#908caa">(),</span> <span style="color:#ea9a97">score</span><span style="color:#908caa">.</span><span style="color:#ea9a97">std</span><span style="color:#908caa">()))</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">s</span><span style="color:#908caa">.</span><span style="color:#ea9a97">append</span><span style="color:#908caa">(</span><span style="color:#f6c177">1</span><span style="color:#908caa">/</span><span style="color:#ea9a97">score</span><span style="color:#908caa">.</span><span style="color:#ea9a97">mean</span><span style="color:#908caa">())</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">score</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">cv_rmse</span><span style="color:#908caa">(</span><span style="color:#ea9a97">gbr</span><span style="color:#908caa">,</span><span style="color:#ea9a97">trainfeature</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">trainresult</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">print</span><span style="color:#908caa">(</span><span style="color:#f6c177">&#34;gboost: </span><span style="color:#f6c177">{:.4f}</span><span style="color:#f6c177"> (</span><span style="color:#f6c177">{:.4f}</span><span style="color:#f6c177">)</span><span style="color:#3e8fb0">\\</span><span style="color:#f6c177">n&#34;</span><span style="color:#908caa">.</span><span style="color:#ea9a97">format</span><span style="color:#908caa">(</span><span style="color:#ea9a97">score</span><span style="color:#908caa">.</span><span style="color:#ea9a97">mean</span><span style="color:#908caa">(),</span> <span style="color:#ea9a97">score</span><span style="color:#908caa">.</span><span style="color:#ea9a97">std</span><span style="color:#908caa">()))</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">s</span><span style="color:#908caa">.</span><span style="color:#ea9a97">append</span><span style="color:#908caa">(</span><span style="color:#f6c177">1</span><span style="color:#908caa">/</span><span style="color:#ea9a97">score</span><span style="color:#908caa">.</span><span style="color:#ea9a97">mean</span><span style="color:#908caa">())</span>
</span></span></code></pre></div><p>Train each of the seven models.</p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ea9a97">lasso_mod</span><span style="color:#908caa">=</span> <span style="color:#ea9a97">lasso</span><span style="color:#908caa">.</span><span style="color:#ea9a97">fit</span><span style="color:#908caa">(</span><span style="color:#ea9a97">trainfeature</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">trainresult</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">ridge_mod</span><span style="color:#908caa">=</span> <span style="color:#ea9a97">ridge</span><span style="color:#908caa">.</span><span style="color:#ea9a97">fit</span><span style="color:#908caa">(</span><span style="color:#ea9a97">trainfeature</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">trainresult</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">elasticnet_mod</span><span style="color:#908caa">=</span> <span style="color:#ea9a97">elasticnet</span><span style="color:#908caa">.</span><span style="color:#ea9a97">fit</span><span style="color:#908caa">(</span><span style="color:#ea9a97">trainfeature</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">trainresult</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">svr_mod</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">svr</span><span style="color:#908caa">.</span><span style="color:#ea9a97">fit</span><span style="color:#908caa">(</span><span style="color:#ea9a97">trainfeature</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">trainresult</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">xgb_mod</span><span style="color:#908caa">=</span> <span style="color:#ea9a97">xgbr</span><span style="color:#908caa">.</span><span style="color:#ea9a97">fit</span><span style="color:#908caa">(</span><span style="color:#ea9a97">trainfeature</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">trainresult</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">gbr_mod</span><span style="color:#908caa">=</span> <span style="color:#ea9a97">gbr</span><span style="color:#908caa">.</span><span style="color:#ea9a97">fit</span><span style="color:#908caa">(</span><span style="color:#ea9a97">trainfeature</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">trainresult</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">stack_mod</span><span style="color:#908caa">=</span> <span style="color:#ea9a97">stackr</span><span style="color:#908caa">.</span><span style="color:#ea9a97">fit</span><span style="color:#908caa">(</span><span style="color:#ea9a97">np</span><span style="color:#908caa">.</span><span style="color:#ea9a97">array</span><span style="color:#908caa">(</span><span style="color:#ea9a97">trainfeature</span><span style="color:#908caa">),</span> <span style="color:#ea9a97">np</span><span style="color:#908caa">.</span><span style="color:#ea9a97">array</span><span style="color:#908caa">(</span><span style="color:#ea9a97">trainresult</span><span style="color:#908caa">))</span>
</span></span></code></pre></div><p>Sum up the reciprocal of 10-fold cross validation errors for the six models (Ridge, Lasso, Elastic Net, SVM Regressor) based on their own performance (Note: to rank the models with larger errors receiving smaller weights, and smaller errors receiving larger weights). Finally, take the average with the result from the Stacking model to get the final prediction result.</p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#6e6a86">#blending</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">s</span><span style="color:#908caa">=</span><span style="color:#908caa">(</span><span style="color:#ea9a97">s</span><span style="color:#908caa">/</span><span style="color:#ea9a97">np</span><span style="color:#908caa">.</span><span style="color:#ea9a97">sum</span><span style="color:#908caa">(</span><span style="color:#ea9a97">s</span><span style="color:#908caa">))</span>
</span></span><span style="display:flex;"><span><span style="color:#3e8fb0">def</span> <span style="color:#ea9a97">blend_predict</span><span style="color:#908caa">(</span><span style="color:#ea9a97">X</span><span style="color:#908caa">):</span>
</span></span><span style="display:flex;"><span>    <span style="color:#3e8fb0">return</span> <span style="color:#ea9a97">np</span><span style="color:#908caa">.</span><span style="color:#ea9a97">exp</span><span style="color:#908caa">(</span><span style="color:#f6c177">0.5</span><span style="color:#908caa">*</span><span style="color:#908caa">((</span><span style="color:#ea9a97">s</span><span style="color:#908caa">[</span><span style="color:#f6c177">0</span><span style="color:#908caa">]</span> <span style="color:#908caa">*</span> <span style="color:#ea9a97">ridge_mod</span><span style="color:#908caa">.</span><span style="color:#ea9a97">predict</span><span style="color:#908caa">(</span><span style="color:#ea9a97">X</span><span style="color:#908caa">))</span><span style="color:#908caa">+</span> <span style="color:#908caa">(</span><span style="color:#ea9a97">s</span><span style="color:#908caa">[</span><span style="color:#f6c177">1</span><span style="color:#908caa">]</span> <span style="color:#908caa">*</span> <span style="color:#ea9a97">lasso_mod</span><span style="color:#908caa">.</span><span style="color:#ea9a97">predict</span><span style="color:#908caa">(</span><span style="color:#ea9a97">X</span><span style="color:#908caa">))</span> <span style="color:#908caa">+</span> 
</span></span><span style="display:flex;"><span>                  <span style="color:#908caa">(</span><span style="color:#ea9a97">s</span><span style="color:#908caa">[</span><span style="color:#f6c177">2</span><span style="color:#908caa">]</span> <span style="color:#908caa">*</span> <span style="color:#ea9a97">elasticnet_mod</span><span style="color:#908caa">.</span><span style="color:#ea9a97">predict</span><span style="color:#908caa">(</span><span style="color:#ea9a97">X</span><span style="color:#908caa">))</span>  <span style="color:#908caa">+</span> <span style="color:#908caa">(</span><span style="color:#ea9a97">s</span><span style="color:#908caa">[</span><span style="color:#f6c177">3</span><span style="color:#908caa">]</span> <span style="color:#908caa">*</span> <span style="color:#ea9a97">svr_mod</span><span style="color:#908caa">.</span><span style="color:#ea9a97">predict</span><span style="color:#908caa">(</span><span style="color:#ea9a97">X</span><span style="color:#908caa">))</span> <span style="color:#908caa">+</span>
</span></span><span style="display:flex;"><span>                  <span style="color:#908caa">(</span><span style="color:#ea9a97">s</span><span style="color:#908caa">[</span><span style="color:#f6c177">4</span><span style="color:#908caa">]</span> <span style="color:#908caa">*</span> <span style="color:#ea9a97">xgb_mod</span><span style="color:#908caa">.</span><span style="color:#ea9a97">predict</span><span style="color:#908caa">(</span><span style="color:#ea9a97">X</span><span style="color:#908caa">))</span><span style="color:#908caa">+</span><span style="color:#908caa">(</span><span style="color:#ea9a97">s</span><span style="color:#908caa">[</span><span style="color:#f6c177">5</span><span style="color:#908caa">]</span> <span style="color:#908caa">*</span> <span style="color:#ea9a97">gbr_mod</span><span style="color:#908caa">.</span><span style="color:#ea9a97">predict</span><span style="color:#908caa">(</span><span style="color:#ea9a97">X</span><span style="color:#908caa">)))</span><span style="color:#908caa">+</span><span style="color:#f6c177">0.5</span><span style="color:#908caa">*</span><span style="color:#ea9a97">stack_mod</span><span style="color:#908caa">.</span><span style="color:#ea9a97">predict</span><span style="color:#908caa">(</span><span style="color:#ea9a97">np</span><span style="color:#908caa">.</span><span style="color:#ea9a97">array</span><span style="color:#908caa">(</span><span style="color:#ea9a97">X</span><span style="color:#908caa">)))</span> <span style="color:#ea9a97">testresult</span><span style="color:#908caa">=</span><span style="color:#ea9a97">blend_predict</span><span style="color:#908caa">(</span><span style="color:#ea9a97">testfeature</span><span style="color:#908caa">)</span>
</span></span></code></pre></div><p>The public score of the final prediction result is approximately 0.1243. (The score is calculated by taking the mean square error of the logarithm of predicted values and actual values. Taking the logarithm of the error values allows for measuring the accuracy of predicting house prices across different scales, without being affected by the magnitude of house prices.)</p>

        </div>

        
        
      </div>
    </div>
  </div>
</section>



<script>
  var indexURL = "https://usausagichan.github.io/english_version/index.json"
</script>

<!-- JS Plugins -->

<script src="https://usausagichan.github.io/english_version/plugins/jQuery/jquery.min.js"></script>

<script src="https://usausagichan.github.io/english_version/plugins/bootstrap/bootstrap.min.js"></script>

<script src="https://usausagichan.github.io/english_version/plugins/slick/slick.min.js"></script>

<script src="https://usausagichan.github.io/english_version/plugins/venobox/venobox.min.js"></script>

<script src="https://usausagichan.github.io/english_version/plugins/search/fuse.min.js"></script>

<script src="https://usausagichan.github.io/english_version/plugins/search/mark.js"></script>

<script src="https://usausagichan.github.io/english_version/plugins/search/search.js"></script>

<!-- Main Script -->

<script src="https://usausagichan.github.io/english_version/js/script.min.js"></script>




<script src="https://cdnjs.cloudflare.com/ajax/libs/js-cookie/2.2.1/js.cookie.min.js"></script>
<div id="js-cookie-box" class="cookie-box cookie-box-hide">
	This site uses cookies. By continuing to use this website, you agree to their use. <span id="js-cookie-button" class="btn btn-sm btn-primary ml-2">I Accept</span>
</div>
<script>
	(function ($) {
		const cookieBox = document.getElementById('js-cookie-box');
		const cookieButton = document.getElementById('js-cookie-button');
		if (!Cookies.get('cookie-box')) {
			cookieBox.classList.remove('cookie-box-hide');
			cookieButton.onclick = function () {
				Cookies.set('cookie-box', true, {
					expires:  2 
				});
				cookieBox.classList.add('cookie-box-hide');
			};
		}
	})(jQuery);
</script>


<style>
.cookie-box {
  position: fixed;
  left: 0;
  right: 0;
  bottom: 0;
  text-align: center;
  z-index: 9999;
  padding: 1rem 2rem;
  background: rgb(71, 71, 71);
  transition: all .75s cubic-bezier(.19, 1, .22, 1);
  color: #fdfdfd;
}

.cookie-box-hide {
  display: none;
}
</style>
</body>
</html>